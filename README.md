# Agri_AI6: 農業AIエージェントシステム

LINEメッセージングを通じて農業従事者にインテリジェントなサポートを提供する次世代AIエージェントシステム

## 🌱 プロジェクトビジョン

**「LINEで完結する、農家のためのAIパートナー」**

本プロジェクトは、日常的に使われるLINEプラットフォームをインターフェースとし、農業従事者に「パーソナライズされ、共に進化するデジタルパートナー」を提供することを目的とします。

キーワード検索の正確性とベクトル検索の文脈理解力を融合したハイブリッド検索により、曖昧な質問や専門用語、過去の作業に関する記憶にも的確に応答し、誰もが熟練者のように自信を持って日々の作業に取り組める未来を実現します。

## 🏗️ システムアーキテクチャ

### マルチエージェント構成（LangGraph Supervisor-Worker パターン）

```mermaid
graph TD
    subgraph "ユーザーインターフェース"
        A[👤 農業従事者] --> B[📱 LINE (チャット / LIFF)]
    end

    subgraph "AIエージェント層 (LangGraph on Google Cloud Run)"
        B -- Webhook --> C[🧠 SupervisorAgent]
        C -- "タスク割当" --> D[📖 ReadAgent]
        C -- "タスク割当" --> E[✏️ WriteAgent]
    end

    subgraph "データベース層 (MongoDB Atlas)"
        D -- "ハイブリッド検索" --> F[Atlas Search & Vector Search]
        E -- "データ書き込み" --> G[Collections]
    end
```

### 主要コンポーネント

- **SupervisorAgent**: 中央司令塔。ユーザー意図を分析し、適切な専門エージェントに処理を委譲
- **ReadAgent**: ハイブリッド検索を活用した情報検索・分析専門エージェント
- **WriteAgent**: 作業記録登録・確認フロー専門エージェント

## 💡 解決する課題

- **情報の散在**: 天気、市況、作業履歴などの情報統合
- **経験と勘への依存**: 新規就農者の判断支援
- **記録と報告の負荷**: 現場での即座な作業記録
- **労働力不足**: 作業計画立案の自動化

## 🎯 開発目標（KPI）

- 農作業の判断・思考時間: **10分 → 0分**
- 新人作業員の迷い時間: **週60分 → 5分未満**
- LINE経由作業記録完了率: **95%以上**
- AI応答時間: **平均3秒以内**

## 🛠️ 技術スタック

| カテゴリ | 技術 |
|---------|------|
| **AI/エージェント** | Python 3.9+, LangChain, LangGraph |
| **LLM** | Google Gemini Pro/Flash |
| **データベース** | MongoDB Atlas (ハイブリッド検索) |
| **インターフェース** | LINE Messaging API, LIFF |
| **インフラ** | Google Cloud Functions/Run, Pub/Sub |
| **監視** | LangSmith |

## 📚 データベース設計

### 設計思想
**「固定されたコア情報 + 農家ごとに自由に拡張できるカスタム情報」**

### 主要コレクション

| コレクション | 説明 |
|-------------|------|
| `farms` | 農業法人・農場基本情報 |
| `users` | LINEアカウント連携作業者情報 |
| `fields` | 圃場詳細（拡張可能なカスタムプロパティ） |
| `work_records` | 日々の作業記録（動的な詳細情報） |

## 🚀 開発ロードマップ

| フェーズ | 期間 | 主要目標 |
|---------|------|----------|
| **Phase 1** | 3週間 | Supervisor+ReadAgentによるハイブリッド検索とLINE基本Q&A |
| **Phase 2** | 3週間 | WriteAgentによる作業記録登録 + 基本LIFFダッシュボード |
| **Phase 3** | 4週間 | RecommendationAgentによる作業提案 + LIFF高機能化 |
| **Phase 4** | 4週間 | NotificationAgentによるプロアクティブ通知 + 非同期処理 |

## 🔍 ハイブリッド検索の威力

- **キーワード検索**: 「農薬スミチオンの散布履歴」「品種りんか409の去年の収穫量」
- **ベクトル検索**: 「葉っぱが黄色くて斑点が出てるんだけど、対策どうすればいい？」
- **ハイブリッド**: MongoDB Atlas の `$rankFusion` で両者の長所を統合

## 📁 重要ドキュメント

- [`docs/LangGraph_マルチエージェント_要件定義書_v4.md`](docs/LangGraph_マルチエージェント_要件定義書_v4.md) - メイン要件仕様書
- [`docs/企画書：LangGraph...構築.md`](docs/企画書：LangGraphとMongoDBハイブリッド検索を活用した次世代LINE%20AIエージェントの構築.md) - 技術アーキテクチャ詳細
- [`CLAUDE.md`](CLAUDE.md) - Claude Code向け開発ガイド

## 🔄 既存資産活用

本システムは「Agri_AI3」の資産と知見を活用：
- 既存11個のLangChainツールを100%流用
- MongoDBスキーマとデータを100%移行
- ドメインロジック（確認フロー等）を90%以上流用

## 📋 現在のステータス

**設計フェーズ完了** - 包括的な要件定義・設計ドキュメントが完成済み。実装準備完了。

---

**目標**: 使うほど賢くなる、農家と共に成長するAIパートナーシステムの実現