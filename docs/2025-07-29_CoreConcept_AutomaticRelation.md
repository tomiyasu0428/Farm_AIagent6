# 重要コンセプト：自然言語からの自動リレーション構築

## 1. 目指す未来像

ユーザーが特別な操作を意識することなく、普段通りの言葉で日報をLINEに投稿するだけで、AIエージェントがその内容を正確に理解し、データベース内の各情報（誰が、いつ、どの圃場で、どの資材を使って、何をしたか）を自動的に関連付けて記録する世界を目指す。

**ユーザー体験の例:**
> ユーザー：「今日は橋前の畑で、殺菌剤のダコニールを散布したよ」

この一文だけで、システムは以下の情報を自動で紐付け、`work_logs`（作業日報）コレクションに保存する。

*   **人物**: `users`コレクションの該当ユーザー
*   **圃場**: `fields`コレクションの「橋前の畑」
*   **資材**: `materials`コレクションの「ダコニール」
*   **作業内容**: 「殺菌剤散布」

## 2. 実現のための技術的アプローチ

この機能は、以下のステップで実現される。

1.  **エージェントの振り分け (`SupervisorAgent`)**:
    *   メッセージが「作業記録」であることを認識し、書き込み専門の`WriteAgent`に処理を委譲する。

2.  **情報抽出 (`WriteAgent` + LLM)**:
    *   `WriteAgent`が、LLM（大規模言語モデル）を用いて自然言語の文章から「圃場名」「資材名」「作業内容」などのエンティティ（固有名詞）を抽出する。

3.  **IDによる関連付け (`WriteAgent` + Tools)**:
    *   抽出したエンティティ名（例：「橋前の畑」）を基に、`FieldRetrievalTool`や`MaterialSearchTool`といった専用ツールを使ってデータベースを検索し、対応する一意なID（例：`field_id: "F001"`）を特定する。

4.  **構造化データの生成と保存**:
    *   特定したID群を使って、リレーショナルな構造を持つJSONデータを生成し、`work_logs`コレクションに保存する。これにより、データ間の関連性が確立される。

5.  **人間による確認 (`Human-in-the-Loop`)**:
    *   「『橋前の畑でダコニールを散布』として記録します。よろしいですか？」のように、最終的な保存前にユーザーに確認を求めることで、AIの誤認識を防ぎ、データの正確性を担保する。

## 3. この機能の重要性

この「自動リレーション機能」は、本プロジェクトが目指す**「考える時間を0にする」**という目標を達成するための根幹をなす。これにより、ユーザーはデータ構造を意識する必要がなくなり、日々の報告がそのまま構造化された農作業データベースになる。これが、将来的な作業提案や経営分析の基盤となる。
